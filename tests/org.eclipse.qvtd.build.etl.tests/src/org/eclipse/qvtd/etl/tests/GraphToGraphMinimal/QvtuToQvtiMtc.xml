<?xml version="1.0"?>
<project default="QvtuToQvtmFlattening">
	<!-- Default Properties -->
	<property name="OclLibURI" value="platform:/resource/org.eclipse.ocl.pivot/model-gen/OCL-2.5.oclas"/>
	<property name="QVTcToQVTuPruning" value="platform:/resource/org.eclipse.qvtd.build.etl/src/org/eclipse/qvtd/build/etl/mtc/QVTcToQVTuPruning.eol"/>
	<property name="QVTcToQVTuFlock" value="platform:/resource/org.eclipse.qvtd.build.etl/src/org/eclipse/qvtd/build/etl/mtc/QVTcToQVTu.mig"/>
	<property name="QVTuToQVTmFlatten" value="platform:/resource/org.eclipse.qvtd.build.etl/src/org/eclipse/qvtd/build/etl/mtc/QVTuToQVTmFlatten.mig"/>
	
    
	<!-- Create for each example/test -->
    <property file="build.properties"/>
	
    <target name="loadModels">
        <!-- OCL Library -->
	    <epsilon.emf.loadModel
	        name = "oclStdLib"
	    	metamodeluri = "http://www.eclipse.org/ocl/2015/Pivot"
	    	modeluri = "${OclLibURI}"
            read="true"
	    	store="false"/>
    	<!-- Configuration -->
        <epsilon.emf.loadModel
            name = "config"
            modelFile = "${configuration}" 
            metamodelUri = "http://www.eclipse.org/qvt/examples/0.1/QVTcConfig"
            read="true" store="false"/>
    	<!-- QVTc -->
        <epsilon.emf.loadModel
            name = "QVTc"
            aliases ="QVT"
		    modelFile = "${qvtcas}" 
            metamodelUri = "http://www.eclipse.org/qvt/2015/QVTcore"
            read="true" store="false"/>
    	<!-- QVTu -->
        <epsilon.emf.loadModel
            name = "QVTu"
        	aliases ="QVT"
            modelFile = "${qvtuas}" 
            metamodelUri = "http://www.eclipse.org/qvt/2015/QVTcore"
            read="false" store="true"/>
    	<!-- QVTm Flatten  -->
        <epsilon.emf.loadModel
        	name = "QVTmFlatten"
        	aliases ="QVT"
            modelFile = "${qvtmflattenas}" 
            metamodelUri = "http://www.eclipse.org/qvt/2015/QVTcore"
            read="false" store="true"/>
	</target>
	
	<!-- Prunning required til Epsilon SVN r2411 goes live -->
	<target name ="prunning" depends="loadModels">
		<epsilon.eol uri="${QVTcToQVTuPruning}" >
			<model ref="QVTc"/>
			<model ref="config"/>
		</epsilon.eol>
	</target>
	
	<target name="QvtcToQvtu" depends="loadModels">
	    <epsilon.flock originalmodel="QVTc" migratedmodel="QVTu" uri="${QVTcToQVTuFlock}">
	        <model ref="QVTc"/>
	    	<model ref="QVTu"/>
	    	<model ref="config"/>
	    	<model ref="oclStdLib"/>
		</epsilon.flock>
	</target>
	
	<target name="QvtuToQvtmFlattening" depends="QvtcToQvtu">
        <epsilon.flock originalmodel="QVTu" migratedmodel="QVTmFlatten" uri="${QVTuToQVTmFlatten}">
            <model ref="QVTu"/>
            <model ref="QVTmFlatten"/>
            <model ref="config"/>
            <model ref="oclStdLib"/>
        </epsilon.flock>
    </target>
	
</project>