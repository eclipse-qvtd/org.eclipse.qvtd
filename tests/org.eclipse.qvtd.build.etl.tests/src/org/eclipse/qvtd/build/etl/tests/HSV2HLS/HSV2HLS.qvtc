import 'HSVTree.ecore'::HSVTree;
import 'HLSTree.ecore'::HLSTree;
import 'HSV2HLS.ecore'::HSV2HLS;

transformation hsv2hls {
    hsv imports HSVTree;  -- Should specify the correct package
    hls imports HLSTree;  --
    imports HSV2HLS;
}

query hsv2hls::hls2rgb(color : HLSTree::HLS) : HSV2HLS::RGB {
	color
}
query hsv2hls::hsv2rgb(color : HSVTree::HSV) : HSV2HLS::RGB {
	color
}
query hsv2hls::rgb2hls(color : HSV2HLS::RGB) : HLSTree::HLS {
	color
}
query hsv2hls::rgb2hsv(color : HSV2HLS::RGB) : HSVTree::HSV {
	color
}

map HSV2HLSRoot in hsv2hls {
    check hsv(hsvRoot : HSVNode |
        hsvRoot.parent = null;) { }
    check enforce hls() {
        realize hlsRoot : HLSNode |
        hlsRoot.parent := null;
    }
    where( ) {
        realize middleRoot : HSVNode2HLSNode |
        middleRoot.hsv := hsvRoot;
        middleRoot.hls := hlsRoot;

    }
    map {
        where() {
            middleRoot.name := hsvRoot.name;
            middleRoot.name := hlsRoot.name;
            hsvRoot.name := middleRoot.name;
            hlsRoot.name := middleRoot.name;
            --middleRoot.rgb := hsv2rgb(hsvRoot.hsv);
            --middleRoot.rgb := hls2rgb(hlsRoot.hls);
            --hsvRoot.hsv := rgb2hsv(middleRoot.rgb);
            --hlsRoot.hls := rgb2hls(middleRoot.rgb);
        }
    }
}

map HSV2HLSRecursion in hsv2hls {
    check enforce hsv(hsvParent : HSVNode | ) {
        realize hsvNode : HSVNode |
        hsvNode.parent := hsvParent;
    }
    check enforce hls(hlsParent : HLSNode |) {
        realize hlsNode : HLSNode |
        hlsNode.parent := hlsParent;
    }
    where(middleParent : HSVNode2HLSNode |
        middleParent.hsv = hsvParent;
        middleParent.hls = hlsParent;
    ) {
        realize middleNode : HSVNode2HLSNode |
        middleNode.parent := middleParent;
        middleNode.hsv := hsvNode;
        middleNode.hls := hlsNode;
        }
    map {
        where () {
            middleNode.name := hsvNode.name;
            middleNode.name := hlsNode.name;
            hlsNode.name := middleNode.name;
            hsvNode.name := middleNode.name;
            --middleNode.rgb := hsv2rgb(hsvNode.hsv);
            --middleNode.rgb := hls2rgb(hlsNode.hls);
            --hsvNode.hsv := rgb2hsv(middleNode.rgb);
            --hlsNode.hls := rgb2hls(middleNode.rgb);
        }
    }
}